from playwright.sync_api import sync_playwright
from datetime import datetime, timedelta

def select_cruise_details():
    with sync_playwright() as p:
        browser = p.chromium.launch(headless=False)  # Set to True for headless
        page = browser.new_page()

        # Visit the website
        page.goto('https://www.costacruises.co.uk/')

        # Accept cookies (if the cookie consent pop-up appears)
        page.locator('button[aria-label="Accept all cookies"]').click()

        # Select "1 Adult"
        page.locator('select[name="adults"]').select_option(label="1")  # Adjust based on actual page structure

        # Set the date range (choosing 7 days ahead for the example)
        today = datetime.today()
        date = today + timedelta(days=7)  # Choosing a date within 7 days
        formatted_date = date.strftime('%d/%m/%Y')

        # Select departure date
        page.locator('input[name="departure_date"]').fill(formatted_date)

        # Select "Transoceanic" as the destination
        page.locator('select[name="destination"]').select_option(label="Transoceanic")

        # Submit the search
        page.locator('button[type="submit"]').click()

        # Wait for results to load
        page.wait_for_selector('.result', timeout=10000)

        print("Cruise search completed successfully")

        browser.close()

select_cruise_details()
